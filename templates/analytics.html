{% extends "base.html" %}

{% block title %}–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –†–∞—Å—á—ë—Ç—ã - –§–∏—Ç–Ω–µ—Å –¢—Ä–µ–∫–µ—Ä{% endblock %}

{% block content %}
<div class="analytics-page">
    <div class="header">
        <h1>üî¨ –ù–∞—É—á–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ —Ä–∞—Å—á—ë—Ç—ã</h1>
        <p>–¢–æ—á–Ω—ã–µ –Ω–∞—É—á–Ω—ã–µ —Ä–∞—Å—á–µ—Ç—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–∞—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö –∏ —Ñ–∏–∑–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π</p>
    </div>

    <div class="analytics-grid">
        <!-- –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –ø—Ä–æ–≥—Ä–µ—Å—Å–∏–∏ -->
        <div class="analytics-card full-width">
            <div class="card-header">
                <h3>üìà –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –ø—Ä–æ–≥—Ä–µ—Å—Å–∏–∏</h3>
                <p>–†–∞—Å—á–µ—Ç –≤—Ä–µ–º–µ–Ω–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ü–µ–ª–µ–π —Å —É—á–µ—Ç–æ–º –∞–¥–∞–ø—Ç–∞—Ü–∏–∏ –∏ –ø–ª–∞—Ç–æ</p>
            </div>
            
            <form id="advanced-progression-form" class="calculator-form">
                <div class="form-group">
                    <label for="advanced-exercise">–£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ:</label>
                    <select id="advanced-exercise" name="exercise_type" required>
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ</option>
                        <option value="–ñ–∏–º –ª–µ–∂–∞">–ñ–∏–º –ª–µ–∂–∞</option>
                        <option value="–°–≤–µ–¥–µ–Ω–∏–µ —Ä—É–∫ –≤ –∫—Ä–æ—Å—Å–æ–≤–µ—Ä–µ –Ω–∞ –≥—Ä—É–¥—å">–°–≤–µ–¥–µ–Ω–∏–µ —Ä—É–∫ –≤ –∫—Ä–æ—Å—Å–æ–≤–µ—Ä–µ –Ω–∞ –≥—Ä—É–¥—å</option>
                        <option value="–†–∞–∑–≥–∏–±–∞–Ω–∏—è –Ω–∞ —Ç—Ä–∏—Ü–µ–ø—Å —Å –∫–∞–Ω–∞—Ç–Ω–æ–π —Ä—É–∫–æ—è—Ç—å—é –≤ –∫—Ä–æ—Å—Å–æ–≤–µ—Ä–µ">–†–∞–∑–≥–∏–±–∞–Ω–∏—è –Ω–∞ —Ç—Ä–∏—Ü–µ–ø—Å —Å –∫–∞–Ω–∞—Ç–Ω–æ–π —Ä—É–∫–æ—è—Ç—å—é –≤ –∫—Ä–æ—Å—Å–æ–≤–µ—Ä–µ</option>
                        <option value="–°–≥–∏–±–∞–Ω–∏—è –Ω–∞ –±–∏—Ü–µ–ø—Å –≤ –†–¢">–°–≥–∏–±–∞–Ω–∏—è –Ω–∞ –±–∏—Ü–µ–ø—Å –≤ –†–¢</option>
                        <option value="–ü–æ–¥—ä–µ–º –Ω–∞ –±–∏—Ü–µ–ø—Å —à—Ç–∞–Ω–≥–∏ –æ–±—Ä–∞—Ç–Ω—ã–º —Ö–≤–∞—Ç–æ–º">–ü–æ–¥—ä–µ–º –Ω–∞ –±–∏—Ü–µ–ø—Å —à—Ç–∞–Ω–≥–∏ –æ–±—Ä–∞—Ç–Ω—ã–º —Ö–≤–∞—Ç–æ–º</option>
                        <option value="–Ø–≥–æ–¥–∏—á–Ω—ã–π –º–æ—Å—Ç –≤ –†–¢">–Ø–≥–æ–¥–∏—á–Ω—ã–π –º–æ—Å—Ç –≤ –†–¢</option>
                        <option value="–†–∞–∑–≥–∏–±–∞–Ω–∏–µ –≥–æ–ª–µ–Ω–∏ –≤ –ë–¢">–†–∞–∑–≥–∏–±–∞–Ω–∏–µ –≥–æ–ª–µ–Ω–∏ –≤ –ë–¢</option>
                        <option value="–°–≥–∏–±–∞–Ω–∏–µ –≥–æ–ª–µ–Ω–∏ –≤ –ë–¢">–°–≥–∏–±–∞–Ω–∏–µ –≥–æ–ª–µ–Ω–∏ –≤ –ë–¢</option>
                        <option value="–ò–∫—Ä–æ–Ω–æ–∂–Ω—ã–µ –≤ –¢">–ò–∫—Ä–æ–Ω–æ–∂–Ω—ã–µ –≤ –¢</option>
                        <option value="–í—Ä–∞—â–µ–Ω–∏—è –≥–∞–Ω—Ç–µ–ª–µ–π –≤ —Å–æ–≥–Ω—É—Ç—ã—Ö —Ä—É–∫–∞—Ö">–í—Ä–∞—â–µ–Ω–∏—è –≥–∞–Ω—Ç–µ–ª–µ–π –≤ —Å–æ–≥–Ω—É—Ç—ã—Ö —Ä—É–∫–∞—Ö</option>
                        <option value="–í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞—è —Ç—è–≥–∞ —Å–∏–¥—è">–í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞—è —Ç—è–≥–∞ —Å–∏–¥—è</option>
                        <option value="–ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è —Ç—è–≥–∞">–ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è —Ç—è–≥–∞</option>
                        <option value="–≠–∫—Å—Ç–µ–Ω–∑–∏—è">–≠–∫—Å—Ç–µ–Ω–∑–∏—è</option>
                        <option value="–°–≥–∏–±–∞–Ω–∏—è –≤ –ø—Ä–µ–¥–ø–ª–µ—á—å—è—Ö">–°–≥–∏–±–∞–Ω–∏—è –≤ –ø—Ä–µ–¥–ø–ª–µ—á—å—è—Ö</option>
                        <option value="–†–∞–±–æ—Ç–∞ —Å –≥–∏—Ä–µ–π –Ω–∞ –ø—Ä–µ–¥–ø–ª–µ—á—å—è">–†–∞–±–æ—Ç–∞ —Å –≥–∏—Ä–µ–π –Ω–∞ –ø—Ä–µ–¥–ø–ª–µ—á—å—è</option>
                    </select>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="advanced-current">–¢–µ–∫—É—â–∏–π –≤–µ—Å (–∫–≥):</label>
                        <input type="number" id="advanced-current" name="current_weight" step="0.5" required>
                    </div>
                    <div class="form-group">
                        <label for="advanced-target">–¶–µ–ª–µ–≤–æ–π –≤–µ—Å (–∫–≥):</label>
                        <input type="number" id="advanced-target" name="target_weight" step="0.5" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="training-age">–°—Ç–∞–∂ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫:</label>
                        <select id="training-age" name="training_age">
                            <option value="1.5">–î–æ 6 –º–µ—Å—è—Ü–µ–≤</option>
                            <option value="1.2" selected>6-12 –º–µ—Å—è—Ü–µ–≤</option>
                            <option value="1.0">1-2 –≥–æ–¥–∞</option>
                            <option value="0.8">2-5 –ª–µ—Ç</option>
                            <option value="0.6">–ë–æ–ª–µ–µ 5 –ª–µ—Ç</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="genetics">–ì–µ–Ω–µ—Ç–∏—á–µ—Å–∫–∏–π –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª:</label>
                        <select id="genetics" name="genetics">
                            <option value="1.3">–í—ã—Å–æ–∫–∏–π</option>
                            <option value="1.1" selected>–°—Ä–µ–¥–Ω–∏–π</option>
                            <option value="0.9">–ù–∏–∑–∫–∏–π</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="advanced-frequency">–¢—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ –≤ –Ω–µ–¥–µ–ª—é:</label>
                        <select id="advanced-frequency" name="frequency">
                            <option value="1">1 —Ä–∞–∑</option>
                            <option value="2" selected>2 —Ä–∞–∑–∞</option>
                            <option value="3">3 —Ä–∞–∑–∞</option>
                            <option value="4">4+ —Ä–∞–∑</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="recovery">–ö–∞—á–µ—Å—Ç–≤–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è:</label>
                        <select id="recovery" name="recovery">
                            <option value="0.9">–ü–ª–æ—Ö–æ–µ</option>
                            <option value="1.0" selected>–°—Ä–µ–¥–Ω–µ–µ</option>
                            <option value="1.1">–•–æ—Ä–æ—à–µ–µ</option>
                            <option value="1.2">–û—Ç–ª–∏—á–Ω–æ–µ</option>
                        </select>
                    </div>
                </div>

                <button type="submit" class="btn-primary full-width-btn">–†–∞—Å—Å—á–∏—Ç–∞—Ç—å –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—É—é –ø—Ä–æ–≥—Ä–µ—Å—Å–∏—é</button>
            </form>

            <div id="advanced-progression-result" class="result-container" style="display: none;">
                <h4>üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–≥–æ —Ä–∞—Å—á–µ—Ç–∞:</h4>
                <div class="result-grid-horizontal">
                    <div class="result-item-horizontal">
                        <div class="result-title">–û–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω—ã–π –ø—Ä–æ–≥–Ω–æ–∑</div>
                        <div class="result-value" id="optimistic-time"></div>
                    </div>
                    <div class="result-item-horizontal">
                        <div class="result-title">–†–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π –ø—Ä–æ–≥–Ω–æ–∑</div>
                        <div class="result-value" id="realistic-time"></div>
                    </div>
                    <div class="result-item-horizontal">
                        <div class="result-title">–ö–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω—ã–π –ø—Ä–æ–≥–Ω–æ–∑</div>
                        <div class="result-value" id="conservative-time"></div>
                    </div>
                </div>
                
                <div class="progression-plan">
                    <h5>üìÖ –ü–ª–∞–Ω –ø—Ä–æ–≥—Ä–µ—Å—Å–∏–∏ –ø–æ –Ω–µ–¥–µ–ª—è–º:</h5>
                    <div id="advanced-progression-chart-container" class="chart-mini">
                        <canvas id="advancedProgressionChart"></canvas>
                    </div>
                </div>

                <div class="training-recommendations">
                    <h5>üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞–º:</h5>
                    <div class="recommendations-list">
                        <div class="recommendation-item">
                            <strong>–ù–µ–¥–µ–ª–∏ 1-4:</strong> –§–æ–∫—É—Å–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ —Ç–µ—Ö–Ω–∏–∫–µ, —É–≤–µ–ª–∏—á–∏–≤–∞–π—Ç–µ –≤–µ—Å –Ω–∞ 2.5–∫–≥ –∫–∞–∂–¥—ã–µ 2 —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏
                        </div>
                        <div class="recommendation-item">
                            <strong>–ù–µ–¥–µ–ª–∏ 5-8:</strong> –î–æ–±–∞–≤—å—Ç–µ 1 –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥, —Ä–∞–±–æ—Ç–∞–π—Ç–µ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ 8-12 –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π
                        </div>
                        <div class="recommendation-item">
                            <strong>–ù–µ–¥–µ–ª–∏ 9-12:</strong> –í–Ω–µ–¥—Ä–∏—Ç–µ —Ç–µ—Ö–Ω–∏–∫—É "–æ—Ç–¥—ã—Ö-–ø–∞—É–∑–∞" –¥–ª—è –ø—Ä–µ–æ–¥–æ–ª–µ–Ω–∏—è –ø–ª–∞—Ç–æ
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- –ù–∞—É—á–Ω—ã–π –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –∫–∞–ª–æ—Ä–∏–π -->
        <div class="analytics-card full-width">
            <div class="card-header">
                <h3>üî• –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –∫–∞–ª–æ—Ä–∏–π</h3>
                <p>–†–∞—Å—á–µ—Ç —Ä–∞—Å—Ö–æ–¥–∞ —ç–Ω–µ—Ä–≥–∏–∏ —Å —É—á–µ—Ç–æ–º –º–µ—Ç–∞–±–æ–ª–∏—á–µ—Å–∫–∏—Ö —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–æ–≤ (MET)</p>
            </div>
            
            <form id="scientific-calories-form" class="calculator-form">
                <div class="form-group">
                    <label for="scientific-exercise">–£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ:</label>
                    <select id="scientific-exercise" name="exercise_type" required>
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ</option>
                        <option value="–ñ–∏–º –ª–µ–∂–∞">–ñ–∏–º –ª–µ–∂–∞</option>
                        <option value="–°–≤–µ–¥–µ–Ω–∏–µ —Ä—É–∫ –≤ –∫—Ä–æ—Å—Å–æ–≤–µ—Ä–µ –Ω–∞ –≥—Ä—É–¥—å">–°–≤–µ–¥–µ–Ω–∏–µ —Ä—É–∫ –≤ –∫—Ä–æ—Å—Å–æ–≤–µ—Ä–µ –Ω–∞ –≥—Ä—É–¥—å</option>
                        <option value="–†–∞–∑–≥–∏–±–∞–Ω–∏—è –Ω–∞ —Ç—Ä–∏—Ü–µ–ø—Å —Å –∫–∞–Ω–∞—Ç–Ω–æ–π —Ä—É–∫–æ—è—Ç—å—é –≤ –∫—Ä–æ—Å—Å–æ–≤–µ—Ä–µ">–†–∞–∑–≥–∏–±–∞–Ω–∏—è –Ω–∞ —Ç—Ä–∏—Ü–µ–ø—Å —Å –∫–∞–Ω–∞—Ç–Ω–æ–π —Ä—É–∫–æ—è—Ç—å—é –≤ –∫—Ä–æ—Å—Å–æ–≤–µ—Ä–µ</option>
                        <option value="–°–≥–∏–±–∞–Ω–∏—è –Ω–∞ –±–∏—Ü–µ–ø—Å –≤ –†–¢">–°–≥–∏–±–∞–Ω–∏—è –Ω–∞ –±–∏—Ü–µ–ø—Å –≤ –†–¢</option>
                        <option value="–ü–æ–¥—ä–µ–º –Ω–∞ –±–∏—Ü–µ–ø—Å —à—Ç–∞–Ω–≥–∏ –æ–±—Ä–∞—Ç–Ω—ã–º —Ö–≤–∞—Ç–æ–º">–ü–æ–¥—ä–µ–º –Ω–∞ –±–∏—Ü–µ–ø—Å —à—Ç–∞–Ω–≥–∏ –æ–±—Ä–∞—Ç–Ω—ã–º —Ö–≤–∞—Ç–æ–º</option>
                        <option value="–Ø–≥–æ–¥–∏—á–Ω—ã–π –º–æ—Å—Ç –≤ –†–¢">–Ø–≥–æ–¥–∏—á–Ω—ã–π –º–æ—Å—Ç –≤ –†–¢</option>
                        <option value="–†–∞–∑–≥–∏–±–∞–Ω–∏–µ –≥–æ–ª–µ–Ω–∏ –≤ –ë–¢">–†–∞–∑–≥–∏–±–∞–Ω–∏–µ –≥–æ–ª–µ–Ω–∏ –≤ –ë–¢</option>
                        <option value="–°–≥–∏–±–∞–Ω–∏–µ –≥–æ–ª–µ–Ω–∏ –≤ –ë–¢">–°–≥–∏–±–∞–Ω–∏–µ –≥–æ–ª–µ–Ω–∏ –≤ –ë–¢</option>
                        <option value="–ò–∫—Ä–æ–Ω–æ–∂–Ω—ã–µ –≤ –¢">–ò–∫—Ä–æ–Ω–æ–∂–Ω—ã–µ –≤ –¢</option>
                        <option value="–í—Ä–∞—â–µ–Ω–∏—è –≥–∞–Ω—Ç–µ–ª–µ–π –≤ —Å–æ–≥–Ω—É—Ç—ã—Ö —Ä—É–∫–∞—Ö">–í—Ä–∞—â–µ–Ω–∏—è –≥–∞–Ω—Ç–µ–ª–µ–π –≤ —Å–æ–≥–Ω—É—Ç—ã—Ö —Ä—É–∫–∞—Ö</option>
                        <option value="–í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞—è —Ç—è–≥–∞ —Å–∏–¥—è">–í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞—è —Ç—è–≥–∞ —Å–∏–¥—è</option>
                        <option value="–ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è —Ç—è–≥–∞">–ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è —Ç—è–≥–∞</option>
                        <option value="–≠–∫—Å—Ç–µ–Ω–∑–∏—è">–≠–∫—Å—Ç–µ–Ω–∑–∏—è</option>
                        <option value="–°–≥–∏–±–∞–Ω–∏—è –≤ –ø—Ä–µ–¥–ø–ª–µ—á—å—è—Ö">–°–≥–∏–±–∞–Ω–∏—è –≤ –ø—Ä–µ–¥–ø–ª–µ—á—å—è—Ö</option>
                        <option value="–†–∞–±–æ—Ç–∞ —Å –≥–∏—Ä–µ–π –Ω–∞ –ø—Ä–µ–¥–ø–ª–µ—á—å—è">–†–∞–±–æ—Ç–∞ —Å –≥–∏—Ä–µ–π –Ω–∞ –ø—Ä–µ–¥–ø–ª–µ—á—å—è</option>
                    </select>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="scientific-duration">–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–º–∏–Ω—É—Ç):</label>
                        <input type="number" id="scientific-duration" name="duration" value="60" min="1" max="240" required>
                    </div>
                    <div class="form-group">
                        <label for="scientific-weight">–í–∞—à –≤–µ—Å (–∫–≥):</label>
                        <input type="number" id="scientific-weight" name="user_weight" value="70" step="0.5" min="30" max="200" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="intensity">–ò–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å:</label>
                        <select id="intensity" name="intensity">
                            <option value="1.0">–ù–∏–∑–∫–∞—è (60-70% –æ—Ç 1–ü–ú)</option>
                            <option value="1.2" selected>–°—Ä–µ–¥–Ω—è—è (70-80% –æ—Ç 1–ü–ú)</option>
                            <option value="1.4">–í—ã—Å–æ–∫–∞—è (80-90% –æ—Ç 1–ü–ú)</option>
                            <option value="1.6">–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è (90-100% –æ—Ç 1–ü–ú)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="rest-ratio">–°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞/–æ—Ç–¥—ã—Ö:</label>
                        <select id="rest-ratio" name="rest_ratio">
                            <option value="1.0">1:1 (–≤—ã—Å–æ–∫–∞—è –ø–ª–æ—Ç–Ω–æ—Å—Ç—å)</option>
                            <option value="0.9">1:2 (—Å—Ä–µ–¥–Ω—è—è –ø–ª–æ—Ç–Ω–æ—Å—Ç—å)</option>
                            <option value="0.8" selected>1:3 (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è)</option>
                            <option value="0.7">1:4 (–Ω–∏–∑–∫–∞—è –ø–ª–æ—Ç–Ω–æ—Å—Ç—å)</option>
                        </select>
                    </div>
                </div>

                <button type="submit" class="btn-primary full-width-btn">–†–∞—Å—Å—á–∏—Ç–∞—Ç—å –Ω–∞—É—á–Ω—ã–º –º–µ—Ç–æ–¥–æ–º</button>
            </form>

            <div id="scientific-calories-result" class="result-container" style="display: none;">
                <h4>üî¨ –ù–∞—É—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞—Å—á–µ—Ç–∞:</h4>
                <div class="result-grid">
                    <div class="result-item">
                        <strong>–û—Å–Ω–æ–≤–Ω–æ–π —Ä–∞—Å—Ö–æ–¥:</strong> 
                        <span id="base-calories"></span> –∫–∫–∞–ª
                    </div>
                    <div class="result-item">
                        <strong>MET –∑–Ω–∞—á–µ–Ω–∏–µ:</strong> 
                        <span id="scientific-met-value"></span>
                    </div>
                </div>
                
                <div class="scientific-comparison">
                    <h5>‚öñÔ∏è –≠–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–∏–µ —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç—ã:</h5>
                    <div class="comparison-items">
                        <div class="comparison-item" id="comparison-walking">
                            <span>üö∂ –•–æ–¥—å–±–∞:</span>
                            <span id="walking-time">0 –º–∏–Ω</span>
                        </div>
                        <div class="comparison-item" id="comparison-running">
                            <span>üèÉ –ë–µ–≥:</span>
                            <span id="running-time">0 –º–∏–Ω</span>
                        </div>
                        <div class="comparison-item" id="comparison-cycling">
                            <span>üö¥ –í–µ–ª–æ—Å–∏–ø–µ–¥:</span>
                            <span id="cycling-time">0 –º–∏–Ω</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- –ù–∞—É—á–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ -->
    <div class="scientific-motivation-section">
        <div class="scientific-recommendations">
            <h3>üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</h3>
            <div class="recommendations-grid">
                <div class="recommendation">
                    <div class="rec-icon">üîÑ</div>
                    <div class="rec-content">
                        <strong>–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –Ω–∞–≥—Ä—É–∑–∫–∏:</strong>
                        <p>–£–≤–µ–ª–∏—á—å—Ç–µ –æ–±—ä–µ–º –Ω–∞ 5-10% –¥–ª—è —Å—Ç–∏–º—É–ª—è—Ü–∏–∏ –≥–∏–ø–µ—Ä—Ç—Ä–æ—Ñ–∏–∏</p>
                    </div>
                </div>
                <div class="recommendation">
                    <div class="rec-icon">‚è±Ô∏è</div>
                    <div class="rec-content">
                        <strong>–í—Ä–µ–º—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è:</strong>
                        <p>–û–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –æ—Ç–¥—ã—Ö–∞ –º–µ–∂–¥—É –ø–æ–¥—Ö–æ–¥–∞–º–∏: 60-90 —Å–µ–∫</p>
                    </div>
                </div>
                <div class="recommendation">
                    <div class="rec-icon">üìä</div>
                    <div class="rec-content">
                        <strong>–ü—Ä–æ–≥—Ä–µ—Å—Å–∏—è:</strong>
                        <p>–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –≤–µ—Å–∞: 2.5% –≤ –Ω–µ–¥–µ–ª—é</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    // –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤
    function animateElement(element, animationName) {
        element.style.animation = `none`;
        setTimeout(() => {
            element.style.animation = `${animationName} 0.6s ease-out`;
        }, 10);
    }

    // –ù–∞—É—á–Ω—ã–π —Ä–∞—Å—á–µ—Ç –∫–∞–ª–æ—Ä–∏–π
    document.getElementById('scientific-calories-form').addEventListener('submit', function(e) {
        e.preventDefault();
        
        const formData = new FormData(this);
        const data = {
            exercise_type: formData.get('exercise_type'),
            duration: parseInt(formData.get('duration')),
            user_weight: parseFloat(formData.get('user_weight')),
            intensity: parseFloat(formData.get('intensity')),
            rest_ratio: parseFloat(formData.get('rest_ratio'))
        };

        calculateScientificCalories(data);
    });

    function calculateScientificCalories(data) {
        // MET –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π
        const metValues = {
            '–ñ–∏–º –ª–µ–∂–∞': 6.0,
            '–°–≤–µ–¥–µ–Ω–∏–µ —Ä—É–∫ –≤ –∫—Ä–æ—Å—Å–æ–≤–µ—Ä–µ –Ω–∞ –≥—Ä—É–¥—å': 5.0,
            '–†–∞–∑–≥–∏–±–∞–Ω–∏—è –Ω–∞ —Ç—Ä–∏—Ü–µ–ø—Å —Å –∫–∞–Ω–∞—Ç–Ω–æ–π —Ä—É–∫–æ—è—Ç—å—é –≤ –∫—Ä–æ—Å—Å–æ–≤–µ—Ä–µ': 4.0,
            '–°–≥–∏–±–∞–Ω–∏—è –Ω–∞ –±–∏—Ü–µ–ø—Å –≤ –†–¢': 4.0,
            '–ü–æ–¥—ä–µ–º –Ω–∞ –±–∏—Ü–µ–ø—Å —à—Ç–∞–Ω–≥–∏ –æ–±—Ä–∞—Ç–Ω—ã–º —Ö–≤–∞—Ç–æ–º': 4.5,
            '–Ø–≥–æ–¥–∏—á–Ω—ã–π –º–æ—Å—Ç –≤ –†–¢': 5.5,
            '–†–∞–∑–≥–∏–±–∞–Ω–∏–µ –≥–æ–ª–µ–Ω–∏ –≤ –ë–¢': 5.0,
            '–°–≥–∏–±–∞–Ω–∏–µ –≥–æ–ª–µ–Ω–∏ –≤ –ë–¢': 5.0,
            '–ò–∫—Ä–æ–Ω–æ–∂–Ω—ã–µ –≤ –¢': 4.0,
            '–í—Ä–∞—â–µ–Ω–∏—è –≥–∞–Ω—Ç–µ–ª–µ–π –≤ —Å–æ–≥–Ω—É—Ç—ã—Ö —Ä—É–∫–∞—Ö': 3.5,
            '–í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞—è —Ç—è–≥–∞ —Å–∏–¥—è': 6.0,
            '–ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è —Ç—è–≥–∞': 6.0,
            '–≠–∫—Å—Ç–µ–Ω–∑–∏—è': 5.5,
            '–°–≥–∏–±–∞–Ω–∏—è –≤ –ø—Ä–µ–¥–ø–ª–µ—á—å—è—Ö': 3.0,
            '–†–∞–±–æ—Ç–∞ —Å –≥–∏—Ä–µ–π –Ω–∞ –ø—Ä–µ–¥–ø–ª–µ—á—å—è': 4.0
        };

        const baseMET = metValues[data.exercise_type] || 5.0;
        const adjustedMET = baseMET * data.intensity * data.rest_ratio;
        
        // –û—Å–Ω–æ–≤–Ω–æ–π —Ä–∞—Å—Ö–æ–¥ –ø–æ —Ñ–æ—Ä–º—É–ª–µ: MET * –≤–µ—Å * –≤—Ä–µ–º—è (–≤ —á–∞—Å–∞—Ö)
        const baseCalories = adjustedMET * data.user_weight * (data.duration / 60);
        
        displayScientificResults({
            baseCalories: Math.round(baseCalories),
            metValue: adjustedMET.toFixed(2)
        });
    }

    function displayScientificResults(result) {
        const resultDiv = document.getElementById('scientific-calories-result');
        
        // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã
        if (document.getElementById('base-calories')) {
            document.getElementById('base-calories').textContent = result.baseCalories;
        }
        if (document.getElementById('scientific-met-value')) {
            document.getElementById('scientific-met-value').textContent = result.metValue;
        }
        
        // –†–∞—Å—á–µ—Ç —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–æ–≤
        if (document.getElementById('walking-time')) {
            document.getElementById('walking-time').textContent = Math.round(result.baseCalories / 4) + ' –º–∏–Ω';
        }
        if (document.getElementById('running-time')) {
            document.getElementById('running-time').textContent = Math.round(result.baseCalories / 10) + ' –º–∏–Ω';
        }
        if (document.getElementById('cycling-time')) {
            document.getElementById('cycling-time').textContent = Math.round(result.baseCalories / 8) + ' –º–∏–Ω';
        }
        
        if (resultDiv) {
            resultDiv.style.display = 'block';
            animateElement(resultDiv, 'slideInUp');
        }
    }

    // –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π —Ä–∞—Å—á–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å–∏–∏
    let advancedProgressionChart = null;

    document.getElementById('advanced-progression-form').addEventListener('submit', function(e) {
        e.preventDefault();
        
        const formData = new FormData(this);
        const data = {
            exercise_type: formData.get('exercise_type'),
            current_weight: parseFloat(formData.get('current_weight')),
            target_weight: parseFloat(formData.get('target_weight')),
            training_age: parseFloat(formData.get('training_age')),
            genetics: parseFloat(formData.get('genetics')),
            frequency: parseInt(formData.get('frequency')),
            recovery: parseFloat(formData.get('recovery'))
        };

        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–æ–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω—ã
        if (!data.exercise_type || !data.current_weight || !data.target_weight) {
            alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è');
            return;
        }

        calculateAdvancedProgression(data);
    });

    function calculateAdvancedProgression(data) {
        const weightDiff = data.target_weight - data.current_weight;
        
        if (weightDiff <= 0) {
            alert('–¶–µ–ª–µ–≤–æ–π –≤–µ—Å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –±–æ–ª—å—à–µ —Ç–µ–∫—É—â–µ–≥–æ –≤–µ—Å–∞');
            return;
        }
        
        // –ë–∞–∑–æ–≤—ã–π —Ä–∞—Å—á–µ—Ç —Å —É—á–µ—Ç–æ–º —Ñ–∞–∫—Ç–æ—Ä–æ–≤
        const baseWeeks = weightDiff / (2.5 * (data.frequency / 2));
        const adjustedWeeks = baseWeeks * data.training_age * data.genetics * data.recovery;
        
        const optimistic = Math.max(1, Math.round(adjustedWeeks * 0.7));
        const realistic = Math.max(1, Math.round(adjustedWeeks));
        const conservative = Math.max(1, Math.round(adjustedWeeks * 1.3));
        
        displayAdvancedProgressionResults({
            optimistic: optimistic,
            realistic: realistic,
            conservative: conservative,
            data: data
        });
    }

    function displayAdvancedProgressionResults(result) {
        const resultDiv = document.getElementById('advanced-progression-result');
        
        if (!resultDiv) return;
        
        // –û–±–Ω–æ–≤–ª—è–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã –ø—Ä–æ–≥–Ω–æ–∑–æ–≤
        if (document.getElementById('optimistic-time')) {
            document.getElementById('optimistic-time').textContent = result.optimistic + ' –Ω–µ–¥–µ–ª—å';
        }
        if (document.getElementById('realistic-time')) {
            document.getElementById('realistic-time').textContent = result.realistic + ' –Ω–µ–¥–µ–ª—å';
        }
        if (document.getElementById('conservative-time')) {
            document.getElementById('conservative-time').textContent = result.conservative + ' –Ω–µ–¥–µ–ª—å';
        }
        
        // –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∏–∏
        buildAdvancedProgressionChart(result);
        
        resultDiv.style.display = 'block';
        animateElement(resultDiv, 'slideInUp');
    }

    function buildAdvancedProgressionChart(result) {
        const ctx = document.getElementById('advancedProgressionChart');
        if (!ctx) return;
        
        const ctx2d = ctx.getContext('2d');
        
        if (advancedProgressionChart) {
            advancedProgressionChart.destroy();
        }
        
        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∏–∏
        const weeks = [];
        const weights = [];
        const currentWeight = result.data.current_weight;
        const targetWeight = result.data.target_weight;
        const realisticWeeks = result.realistic;
        
        for (let week = 0; week <= realisticWeeks; week++) {
            weeks.push(`–ù–µ–¥–µ–ª—è ${week}`);
            // –õ–∏–Ω–µ–π–Ω–∞—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∏—è —Å –Ω–µ–±–æ–ª—å—à–∏–º —É—Å–∫–æ—Ä–µ–Ω–∏–µ–º –≤ –Ω–∞—á–∞–ª–µ
            const progress = week / realisticWeeks;
            const weight = currentWeight + (targetWeight - currentWeight) * progress;
            weights.push(Math.round(weight * 10) / 10); // –û–∫—Ä—É–≥–ª—è–µ–º –¥–æ 0.1 –∫–≥
        }
        
        // –î–æ–±–∞–≤–ª—è–µ–º —Ü–µ–ª–µ–≤—É—é —Ç–æ—á–∫—É
        if (realisticWeeks > 0) {
            weeks.push(`–¶–µ–ª—å`);
            weights.push(targetWeight);
        }

        advancedProgressionChart = new Chart(ctx2d, {
            type: 'line',
            data: {
                labels: weeks,
                datasets: [{
                    label: '–ü–ª–∞–Ω –ø—Ä–æ–≥—Ä–µ—Å—Å–∏–∏ –≤–µ—Å–∞',
                    data: weights,
                    borderColor: '#4b5563',
                    backgroundColor: 'rgba(75, 85, 99, 0.1)',
                    tension: 0.4,
                    fill: true,
                    pointBackgroundColor: '#4b5563',
                    pointBorderColor: '#ffffff',
                    pointBorderWidth: 2
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    title: {
                        display: true,
                        text: '–ü–ª–∞–Ω —É–≤–µ–ª–∏—á–µ–Ω–∏—è —Ä–∞–±–æ—á–µ–≥–æ –≤–µ—Å–∞'
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                return `–í–µ—Å: ${context.parsed.y.toFixed(1)} –∫–≥`;
                            }
                        }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: false,
                        title: {
                            display: true,
                            text: '–í–µ—Å (–∫–≥)'
                        }
                    },
                    x: {
                        title: {
                            display: true,
                            text: '–í—Ä–µ–º–µ–Ω–Ω–∞—è —à–∫–∞–ª–∞'
                        }
                    }
                }
            }
        });
    }

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    document.addEventListener('DOMContentLoaded', function() {
        // –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è –∫–∞—Ä—Ç–æ—á–µ–∫
        setTimeout(() => {
            document.querySelectorAll('.analytics-card').forEach((card, index) => {
                setTimeout(() => {
                    animateElement(card, 'fadeInUp');
                }, index * 100);
            });
        }, 300);
    });
</script>

<style>
    /* –ê–Ω–∏–º–∞—Ü–∏–∏ */
    @keyframes fadeInUp {
        from {
            opacity: 0;
            transform: translateY(30px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    @keyframes slideInUp {
        from {
            opacity: 0;
            transform: translateY(50px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    @keyframes fadeIn {
        from {
            opacity: 0;
        }
        to {
            opacity: 1;
        }
    }

    /* –ê–Ω–∏–º–∞—Ü–∏—è –¥–ª—è –∫–∞—Ä—Ç–æ—á–µ–∫ */
    .analytics-card {
        animation: fadeInUp 0.6s ease-out;
        animation-fill-mode: both;
    }

    /* –ö–Ω–æ–ø–∫–∞ –Ω–∞ –≤—Å—é —à–∏—Ä–∏–Ω—É */
    .full-width-btn {
        width: 100%;
        text-align: center;
        justify-content: center;
    }

    /* –°—Ç–∏–ª–∏ –¥–ª—è –º–æ—Ç–∏–≤–∞—Ü–∏–æ–Ω–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ */
    .scientific-motivation-section {
        background: linear-gradient(135deg, #1e293b, #334155);
        color: white;
        padding: 2.5rem;
        border-radius: var(--radius-xl);
        margin-top: 2rem;
        box-shadow: var(--shadow-xl);
        animation: fadeInUp 0.8s ease-out;
    }

    .result-grid-horizontal {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 1rem;
        margin: 1.5rem 0;
    }

    .result-item-horizontal {
        background: white;
        padding: 1.5rem;
        border-radius: var(--radius-lg);
        text-align: center;
        border: 2px solid var(--border-color);
        transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .result-item-horizontal:hover {
        transform: translateY(-5px);
        box-shadow: var(--shadow-lg);
    }

    .result-title {
        font-weight: 600;
        color: var(--text-primary);
        margin-bottom: 0.5rem;
        font-size: 0.9rem;
    }

    .result-value {
        font-size: 1.5rem;
        font-weight: 800;
        color: var(--primary-color);
    }

    .scientific-recommendations {
        margin-top: 0;
    }

    .calories-breakdown, .scientific-comparison {
        margin-top: 1.5rem;
        padding-top: 1rem;
        border-top: 1px solid var(--border-color);
    }

    .comparison-items {
        display: flex;
        flex-direction: column;
        gap: 0.75rem;
    }

    .comparison-item {
        display: flex;
        justify-content: space-between;
        padding: 0.75rem;
        background: var(--light-bg);
        border-radius: var(--radius-md);
        font-size: 0.9rem;
        transition: transform 0.2s ease;
    }

    .comparison-item:hover {
        transform: translateX(5px);
    }

    .stats-overview {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1rem;
        margin-bottom: 2rem;
    }

    .stat-card {
        background: white;
        padding: 1.5rem;
        border-radius: var(--radius-lg);
        text-align: center;
        border: 2px solid var(--border-color);
        transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .stat-card:hover {
        transform: translateY(-5px);
        box-shadow: var(--shadow-lg);
    }

    .stat-value {
        font-size: 2.5rem;
        font-weight: 800;
        color: var(--text-primary);
        margin: 0.5rem 0;
    }

    .stat-trend {
        font-size: 0.8rem;
        font-weight: 600;
    }

    .stat-trend.positive {
        color: #10b981;
    }

    /* –°—Ç–∏–ª–∏ –¥–ª—è —Å–ø–∏—Å–∫–∞ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π */
    .exercises-list {
        display: flex;
        flex-direction: column;
        gap: 1rem;
    }

    .exercise-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 1rem;
        background: white;
        border-radius: var(--radius-md);
        border: 1px solid var(--border-color);
        transition: transform 0.2s ease;
    }

    .exercise-item:hover {
        transform: translateX(5px);
        border-color: var(--primary-color);
    }

    .exercise-name {
        font-weight: 600;
        color: var(--text-primary);
        flex: 1;
    }

    .exercise-stats {
        display: flex;
        gap: 1rem;
    }

    .exercise-stats .stat {
        background: var(--light-bg);
        padding: 0.25rem 0.75rem;
        border-radius: var(--radius-sm);
        font-size: 0.8rem;
        font-weight: 500;
    }

    .no-data-message {
        text-align: center;
        padding: 3rem;
        color: var(--text-secondary);
        font-style: italic;
    }

    .recommendations-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 1.5rem;
        margin-top: 1.5rem;
    }

    .recommendation {
        display: flex;
        align-items: flex-start;
        gap: 1rem;
        padding: 1.5rem;
        background: rgba(255, 255, 255, 0.1);
        border-radius: var(--radius-lg);
        border: 1px solid rgba(255, 255, 255, 0.2);
        transition: transform 0.3s ease;
    }

    .recommendation:hover {
        transform: translateY(-3px);
    }

    .rec-icon {
        font-size: 1.5rem;
        flex-shrink: 0;
    }

    .rec-content strong {
        display: block;
        margin-bottom: 0.5rem;
        color: white;
    }

    .rec-content p {
        margin: 0;
        opacity: 0.9;
        font-size: 0.9rem;
    }

    /* –°—Ç–∏–ª–∏ –¥–ª—è –ø–ª–∞–Ω–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∏–∏ */
    .progression-plan {
        margin-top: 1.5rem;
    }

    .training-recommendations {
        margin-top: 1.5rem;
        padding-top: 1rem;
        border-top: 1px solid var(--border-color);
    }

    .recommendations-list {
        display: flex;
        flex-direction: column;
        gap: 0.75rem;
    }

    .recommendation-item {
        padding: 1rem;
        background: var(--light-bg);
        border-radius: var(--radius-md);
        font-size: 0.9rem;
        transition: transform 0.2s ease;
    }

    .recommendation-item:hover {
        transform: translateX(5px);
    }

    .recommendation-item strong {
        color: var(--primary-color);
    }

    @media (max-width: 768px) {
        .result-grid-horizontal {
            grid-template-columns: 1fr;
        }
        
        .recommendations-grid {
            grid-template-columns: 1fr;
        }
        
        .exercise-item {
            flex-direction: column;
            align-items: flex-start;
            gap: 0.5rem;
        }
        
        .exercise-stats {
            width: 100%;
            justify-content: space-between;
        }
    }
</style>
{% endblock %}